# Действия 2.0

# EcoRouter + Alt 

# 1. Базовая настройка

EcoRouter:

    en
    conf t
    hostname R1.?au-team.irpo?
    hostname R2.?au-team.irpo?
    ip domain-name ?au-team.irpo?
    write memory

Alt:

    hostnamectl set-hostname Cli.au.team.irpo;exec bash
    hostnamectl set-hostname Admin.au.team.irpo;exec bash

# 2. Настройка Сети

R1

EcoRouter:

Internet

    interface ge0 (alt te0)
    description "Internet"
    ip address ???
    exit
  .

    port ge0
    service-instance ge0/ge0 (alt te0)
    encapsulation untagged 
    connect ip interface ge0
    exit
    exit
.

    ip route 0.0.0.0/0 ?172.16.4.1?
    write
    show ip interface brief
Admin
    
    interface ?vl100? (+/-)
    description "Admins - vlan100"
    ip address 192.168.101.1/24
    exit
.

    port te1 (alt ge1)
    service-instance te1/vl100 (alt ge1)
    encapsulation dot1q 100 exact 
    rewrite pop 1
    connect ip interface vl100
    exit
Client

    interface vl200
    description "Clients - vlan200"
    ip address 192.168.101.11/24
    exit
.
  
    port te1 (alt ge1)
    service-instance te1/vl200 (alt ge1)
    encapsulation dot1q 200 exact 
    rewrite pop 1
    connect ip interface vl200
    exit
    write memory
    show ip interface brief
Cam1

    interface Cam1/te2/ge2 (Cams)
    description "Cam1 - Cams"
    ip address 192.168.120.1/24  
.

    port te2/ge2
    service-instance te2/ge2/Cam1
    ?encapsulation dot1q 100 exact? 
    ?rewrite pop 1?
    connect ip interface Cam1
    exit
R1 <=> R2 (50/50)
    
    interface te3/ge3/Router2 (R2)
    description "Router2 - R2"
    ip address 10.10.10.10.1/30
.    

    port te3/ge3
    service-instance te3/ge3/Router2
    ?encapsulation dot1q 200 exact? 
    ?rewrite pop 1?
    connect ip interface Router2
    exit
    write memory
R2
  
R2 <=> R1 (50/50)
  
    interface te3/ge3/Router1 (R1)
    description "Router1 - R1"
    ip address 10.10.10.10.2/30
.    

    port te3/ge3
    service-instance te3/ge3/Router2
    ?encapsulation dot1q 200 exact? 
    ?rewrite pop 1?
    connect ip interface Router2
    exit
    write memory
Printer
  
    interface te1/ge1/Printer
    description "Connect Printer"
    ip address 192.168.102.1/24  
.

    port te1/ge1
    service-instance te1/Printer
    ?encapsulation dot1q 100 exact? 
    ?rewrite pop 1?
    connect ip interface te1/ge1/Printer
Cam2

    interface Cam2/te2/ge2 (Cams)
    description "Cam2 - Cams"
    ip address 192.168.110.1/24  
.

    port te2/ge2
    service-instance Cam2/te2/ge2
    ?encapsulation dot1q 100 exact? 
    ?rewrite pop 1?
    connect ip interface Cam2/te2/ge2
    exit
    write memory
    show ip interface brief

Alt Linux:

    Через панель управления
# 3. Настройка DHCP, DNS?, NAT? OSPFv2?
  
Ecoruter:

Cli

    configure terminal
    ip pool CLI 192.168.101.11-192.168.101.253
  .
  
    dhcp-server 1
    pool CLI 1
    mask 24
    gateway 192.168.101.1/254
    dns ???
    domain-name ???
    exit
    exit
.

    interface vl200
    dhcp-server 1
    exit
    write
Internet

    configure terminal
    ip pool Int ???-???
  .
  
    dhcp-server 2
    pool Int 1
    mask 24
    gateway ???
    dns ???
    domain-name ???
    exit
    exit
.

    interface ge0 (alt te0)
    dhcp-server 2
    exit
    write
NAT?

    configure terminal
    interface ge0 (alt te0)
    ip nat outside
    exit
    
    interface vl100
    ip nat inside
    exit
    interface vl200
    ip nat inside
    exit
    interface Cam1/te2/ge2 (Cams)
    ip nat inside
    interface te3/ge3/Router2
    ip nat inside
    exit
.

    ip nat pool LOCAL 192.168.101.1-192.168.101.254
    ip nat source dynamic inside-to-outside pool LOCAL overload interface ge0 (alt te0) 
    write

OSPFv2?

R1

    configure terminal 
    router ospf 1
    ?ospf router-id 10.10.10.1?
    ?passive-interface default?
    ?no passive-interface tunnel.0?
    ?network 10.10.10.0/30 area 0?
    network 192.168.101.10/24 area 0
    network 192.168.101.11/24 area 0
    network 192.168.120.0/24 area 0
    exit
R2

    configure terminal 
    router ospf 1
    ?ospf router-id 10.10.10.2?
    ?passive-interface default?
    ?no passive-interface tunnel.0?
    ?network 10.10.10.0/30 area 0?
    network 192.168.102.0/24 area 0
    network 192.168.110.0/24 area 0
    exit
R1,2

    interface tunnel.0
    ip ospf authentication message-digest 
    ip ospf message-digest-key 1 md5 P@ssw0rd
    exit
    write memory
.

    show ip ospf neighbor 
    show ip route ospf
    show ip opsf interface tunnel.0 
    ip -br a
    Admin: ping 192.168.120.25, 192.168.110.25, 192.168.102.10
# 4. Настройка пользователя

EcoRouter:

    username net_admin
    password P@$$word
    role admin
    exit
    exit
    write

Alt Linux:

    adduser sshuser -u 1010
    passwd sshuser
    P@ssw0rd
    P@ssw0rd
    echo "sshuser ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers
    usermod -aG wheel sshuser
    sudo -i
    ИЛИ
    через Панель Управления
# 5. Tunnel? R1 <=> R2
    
    configure terminal
    interface tunnel.0
    description "R1-to-R2"
    ip address 10.10.10.1/30
    ip tunnel ?10.10.10.1? ?10.10.10.2? mode gre
    end
    write memory
.

    configure terminal
    interface tunnel.0
    description "R2-to-R1"
    ip address 10.10.10.2/30
    ip tunnel ?10.10.10.2? ?10.10.10.1? mode gre
    end
    write memory
# 5. Printer?

    Menu -> Администрирование -> Настройки Принтера 
    Добавить -> Сетевой Принтер -> IP Printer -> Установить Драва -> По Умолчанию -> Задать Имя
    https://www.altlinux.org/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%BF%D1%80%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%B0#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE_%D0%BF%D1%80%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%B0
# 6. Cams?
